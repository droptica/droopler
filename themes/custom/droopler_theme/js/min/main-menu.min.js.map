{"version":3,"file":"main-menu.min.js","sources":["main-menu.js"],"sourcesContent":["/**\n * @file\n * Main menu operation.\n */\n(function ($, Drupal) {\n\n  \"use strict\";\n  var $clearStyling = false;\n\n  Drupal.behaviors.mainMenuMobileOperations = {\n    attach: function (context, settings) {\n      var $block = $('.we-mega-menu-submenu .block-block-content', context);\n      var $titles = $('.field--name-field-d-main-title', $block);\n\n      if ($titles.length) {\n        var breakpointDesktop = 992;\n        var blockContentClass = '.field--name-field-d-long-text';\n\n        $titles.once().click(function() {\n          if (window.innerWidth < breakpointDesktop) {\n            $(this).toggleClass('open').parent().find(blockContentClass).slideToggle('medium', function () {\n              if ($(this).is(':hidden')) {\n                $clearStyling = true;\n              }\n            });\n\n            return false;\n          }\n        });\n      }\n    }\n  };\n\n  /**\n   * Adds body tag class when mobile sidebar is opened.\n   * Required for disabling body scroll and adding overlay.\n   *\n   * @type {{attach: Drupal.behaviors.mainMenuMobileNavbarListener.attach}}\n   */\n  Drupal.behaviors.mainMenuMobileNavbarListener = {\n    attach: function (context, settings) {\n      $ ('#navbar-main button.navbar-toggler', context).once('d_main_menu_open').click(function() {\n        if (!$('.navbar').hasClass('collapsing')) {\n          $('body').toggleClass('navbar-open');\n          $('.navbar').toggleClass('open');\n          $('html, body').stop().animate({scrollTop: 0}, 500);\n          $(this).attr('aria-expanded', ($(this).attr('aria-expanded') === 'false'));\n        }\n      });\n\n      // Close sidebar when clicked overflowed content.\n      $('.main-navbar', context).once('d_main_menu_close').click(function(e) {\n        var $clickTarget = $(e.target);\n        if ($clickTarget.parents('.navbar-inner').length == 0 && $clickTarget.is('.navbar-inner') == false) {\n          $ ('#navbar-main button.navbar-toggler:visible', context).click();\n        }\n      });\n    }\n  };\n\n  /**\n   * Adding toggle behavior for sidebar menu items having submenus.\n   *\n   * @type {{attach: Drupal.behaviors.mainMenuMobileSubmenuToggle.attach}}\n   */\n  Drupal.behaviors.mainMenuMobileSubmenuToggle = {\n    attach: function (context, settings) {\n      var $menuItems = $('.we-mega-menu-li.with-submenu', context);\n      var $links = $('> a.we-mega-menu-li, > span.we-megamenu-nolink', $menuItems);\n\n      if ($links.length) {\n        var blockContentClass = '.we-mega-menu-submenu';\n        var $mainNavbar = $('.main-navbar');\n\n        $links.each(function() {\n          var $thisLink = $(this);\n          $thisLink.toggleClass('open', $thisLink.parent().is('.active'));\n\n          // The item can be <a> tag or just a <span> if no link available - then the whole <span> is a toggler.\n          var $expander = $thisLink;\n          var $collapser = $thisLink.is('a') ? $thisLink.find('.d-submenu-toggler') : $thisLink;\n\n          $expander.once().click(function () {\n            var $linkItem = $(this);\n            if ($linkItem.is('a.open') || $mainNavbar.is(':not(.show)')) {\n              return true;\n            }\n            $linkItem.toggleClass('open').next(blockContentClass).find('> .we-mega-menu-submenu-inner').slideToggle('medium', function () {\n              if ($(this).is(':hidden')) {\n                $clearStyling = true;\n              }\n            });\n\n            return false;\n          });\n\n          $collapser.once().click(function() {\n            if ($mainNavbar.is(':not(.show)')) {\n              return true;\n            }\n            var $linkItem = $(this);\n            if ($linkItem.is('.d-submenu-toggler')) {\n              $linkItem = $linkItem.parent();\n            }\n            $linkItem.toggleClass('open').next(blockContentClass).find('> .we-mega-menu-submenu-inner').slideToggle('medium', function () {\n              if ($(this).is(':hidden')) {\n                $clearStyling = true;\n              }\n            });\n\n            return false;\n          });\n        });\n      }\n    }\n  };\n\n  Drupal.behaviors.mainMenuDeepActiveTrail = {\n    attach: function (context, settings) {\n      var $menu = $('nav.navbar', context);\n\n      if (window.location.pathname == '/') {\n        return false;\n      }\n      $menu.find('a[href$=\"' + window.location.pathname + '\"]').each(function() {\n        var $matchingLinkTag = $(this);\n        $matchingLinkTag.addClass('active-menu-item');\n        // Some links are placed in basic submenus.\n        $matchingLinkTag.parents('.we-mega-menu-li.with-submenu').addClass('active-trail open');\n        // Some links are placed in mega menu blocks.\n        $matchingLinkTag.parents('.type-of-block').addClass('active-trail open');\n      });\n    }\n  };\n\n  /**\n   * jQuery slideUp method leaves \"display: none\" inline styling.\n   * We need to remove it if some of menu elements was hidden and\n   * then screen resolution was resized up to minimum 992px to make\n   * them visible again.\n   *\n   * @type {{attach: Drupal.behaviors.unsetHiddenNavElements.attach}}\n   */\n  Drupal.behaviors.unsetHiddenNavElements = {\n    attach: function (context, settings) {\n      var $menu = $('nav.navbar', context);\n      $(window).once('d_main_menu_resize').resize(function() {\n        if (window.innerWidth > 992 && $clearStyling) {\n          $menu.find('[style*=\"display: none\"]').removeAttr('style');\n          $clearStyling = false;\n        }\n      });\n    }\n  };\n\n})(jQuery, Drupal);\n"],"names":["$","Drupal","$clearStyling","behaviors","mainMenuMobileOperations","attach","context","settings","$block","$titles","length","once","click","window","innerWidth","this","toggleClass","parent","find","slideToggle","is","mainMenuMobileNavbarListener","hasClass","stop","animate","scrollTop","attr","e","$clickTarget","target","parents","mainMenuMobileSubmenuToggle","blockContentClass","$mainNavbar","$menuItems","$links","each","$thisLink","$expander","$collapser","$linkItem","next","mainMenuDeepActiveTrail","$menu","location","pathname","$matchingLinkTag","addClass","unsetHiddenNavElements","resize","removeAttr","jQuery"],"mappings":"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"}