{"version":3,"file":"main-menu.min.js","sources":["main-menu.js"],"sourcesContent":["/**\n * @file\n * Main menu operation.\n */\n(function ($, Drupal) {\n\n  \"use strict\";\n  var $clearStyling = false;\n\n  Drupal.behaviors.mainMenuMobileOperations = {\n    attach: function (context, settings) {\n      var $block = $('.we-mega-menu-submenu .block-block-content', context);\n      var $titles = $('.field--name-field-d-main-title', $block);\n\n      if ($titles.length) {\n        var breakpointDesktop = 992;\n        var blockContentClass = '.field--name-field-d-long-text';\n\n        $titles.once().click(function() {\n          if (window.innerWidth < breakpointDesktop) {\n            $(this).toggleClass('open').parent().find(blockContentClass).slideToggle('medium', function () {\n              if ($(this).is(':hidden')) {\n                $clearStyling = true;\n              }\n            });\n\n            return false;\n          }\n        });\n      }\n    }\n  };\n\n  /**\n   * Adds body tag class when mobile sidebar is opened.\n   * Required for disabling body scroll and adding overlay.\n   *\n   * @type {{attach: Drupal.behaviors.mainMenuMobileNavbarListener.attach}}\n   */\n  Drupal.behaviors.mainMenuMobileNavbarListener = {\n    attach: function (context, settings) {\n      $ ('#navbar-main button.navbar-toggler', context).once('d_main_menu_open').click(function() {\n        if (!$('.navbar').hasClass('collapsing')) {\n          $('body').toggleClass('navbar-open');\n          $('.navbar').toggleClass('open');\n          $('html, body').stop().animate({scrollTop: 0}, 500);\n          $(this).attr('aria-expanded', ($(this).attr('aria-expanded') === 'false'));\n        }\n      });\n\n      // Close sidebar when clicked overflowed content.\n      $('.main-navbar', context).once('d_main_menu_close').click(function(e) {\n        var $clickTarget = $(e.target);\n        if ($clickTarget.parents('.navbar-inner').length == 0 && $clickTarget.is('.navbar-inner') == false) {\n          $ ('#navbar-main button.navbar-toggler:visible', context).click();\n        }\n      });\n    }\n  };\n\n  /**\n   * Adding toggle behavior for sidebar menu items having submenus.\n   *\n   * @type {{attach: Drupal.behaviors.mainMenuMobileSubmenuToggle.attach}}\n   */\n  Drupal.behaviors.mainMenuMobileSubmenuToggle = {\n    attach: function (context, settings) {\n      var $menuItems = $('.we-mega-menu-li.with-submenu', context);\n      var $links = $('> a.we-mega-menu-li, > span.we-megamenu-nolink', $menuItems);\n\n      if ($links.length) {\n        var blockContentClass = '.we-mega-menu-submenu';\n        var $mainNavbar = $('.main-navbar');\n\n        $links.each(function() {\n          var $thisLink = $(this);\n          $thisLink.toggleClass('open', $thisLink.parent().is('.active'));\n\n          // The item can be <a> tag or just a <span> if no link available - then the whole <span> is a toggler.\n          var $expander = $thisLink;\n          var $collapser = $thisLink.is('a') ? $thisLink.find('.d-submenu-toggler') : $thisLink;\n\n          $expander.once().click(function () {\n            var $linkItem = $(this);\n            if ($linkItem.is('a.open') || $mainNavbar.is(':not(.show)')) {\n              return true;\n            }\n            $linkItem.toggleClass('open').next(blockContentClass).find('> .we-mega-menu-submenu-inner').slideToggle('medium', function () {\n              if ($(this).is(':hidden')) {\n                $clearStyling = true;\n              }\n            });\n\n            return false;\n          });\n\n          $collapser.once().click(function() {\n            if ($mainNavbar.is(':not(.show)')) {\n              return true;\n            }\n            var $linkItem = $(this);\n            if ($linkItem.is('.d-submenu-toggler')) {\n              $linkItem = $linkItem.parent();\n            }\n            $linkItem.toggleClass('open').next(blockContentClass).find('> .we-mega-menu-submenu-inner').slideToggle('medium', function () {\n              if ($(this).is(':hidden')) {\n                $clearStyling = true;\n              }\n            });\n\n            return false;\n          });\n        });\n      }\n    }\n  };\n\n  Drupal.behaviors.mainMenuDeepActiveTrail = {\n    attach: function (context, settings) {\n      var $menu = $('nav.navbar', context);\n\n      if (window.location.pathname == '/') {\n        return false;\n      }\n      $menu.find('a[href$=\"' + window.location.pathname + '\"]').each(function() {\n        var $matchingLinkTag = $(this);\n        $matchingLinkTag.addClass('active-menu-item');\n        // Some links are placed in basic submenus.\n        $matchingLinkTag.parents('.we-mega-menu-li.with-submenu').addClass('active-trail open');\n        // Some links are placed in mega menu blocks.\n        $matchingLinkTag.parents('.type-of-block').addClass('active-trail open');\n      });\n    }\n  };\n\n  /**\n   * jQuery slideUp method leaves \"display: none\" inline styling.\n   * We need to remove it if some of menu elements was hidden and\n   * then screen resolution was resized up to minimum 992px to make\n   * them visible again.\n   *\n   * @type {{attach: Drupal.behaviors.unsetHiddenNavElements.attach}}\n   */\n  Drupal.behaviors.unsetHiddenNavElements = {\n    attach: function (context, settings) {\n      var $menu = $('nav.navbar', context);\n      $(window).once('d_main_menu_resize').resize(function() {\n        if (window.innerWidth > 992 && $clearStyling) {\n          $menu.find('[style*=\"display: none\"]').removeAttr('style');\n          $clearStyling = false;\n        }\n      });\n    }\n  };\n\n})(jQuery, Drupal);\n"],"names":["$","Drupal","$clearStyling","behaviors","mainMenuMobileOperations","attach","context","settings","$block","$titles","length","once","click","window","innerWidth","this","toggleClass","parent","find","slideToggle","is","mainMenuMobileNavbarListener","hasClass","stop","animate","scrollTop","attr","e","$clickTarget","target","parents","mainMenuMobileSubmenuToggle","blockContentClass","$mainNavbar","$menuItems","$links","each","$thisLink","$expander","$collapser","$linkItem","next","mainMenuDeepActiveTrail","$menu","location","pathname","$matchingLinkTag","addClass","unsetHiddenNavElements","resize","removeAttr","jQuery"],"mappings":"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"}